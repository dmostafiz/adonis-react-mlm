"use strict";
(self["webpackChunkadonismlm"] = self["webpackChunkadonismlm"] || []).push([["vendors-node_modules_web3auth_wallet-connect-v1-adapter_dist_walletConnectV1Adapter_esm_js"],{

/***/ "./node_modules/@web3auth/wallet-connect-v1-adapter/dist/walletConnectV1Adapter.esm.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@web3auth/wallet-connect-v1-adapter/dist/walletConnectV1Adapter.esm.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WalletConnectV1Adapter": () => (/* binding */ WalletConnectV1Adapter)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");
/* harmony import */ var _walletconnect_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @walletconnect/client */ "./node_modules/@walletconnect/client/dist/esm/index.js");
/* harmony import */ var _web3auth_base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @web3auth/base */ "./node_modules/@web3auth/base/dist/base.esm.js");
/* harmony import */ var _web3auth_ethereum_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @web3auth/ethereum-provider */ "./node_modules/@web3auth/ethereum-provider/dist/ethereumProvider.esm.js");





const WALLET_CONNECT_EXTENSION_ADAPTERS = [{
  name: "Rainbow",
  chains: [_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.CHAIN_NAMESPACES.EIP155],
  logo: "https://images.web3auth.io/login-rainbow.svg",
  mobile: {
    native: "rainbow:",
    universal: "https://rnbwapp.com"
  },
  desktop: {
    native: "",
    universal: ""
  }
}, {
  name: "MetaMask",
  chains: [_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.CHAIN_NAMESPACES.EIP155],
  logo: "https://images.web3auth.io/login-metamask.svg",
  mobile: {
    native: "metamask:",
    universal: "https://metamask.app.link"
  },
  desktop: {
    native: "",
    universal: ""
  }
}];

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

class WalletConnectV1Adapter extends _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.BaseAdapter {
  constructor() {
    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    super();

    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(this, "name", _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WALLET_ADAPTERS.WALLET_CONNECT_V1);

    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(this, "adapterNamespace", _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_NAMESPACES.EIP155);

    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(this, "currentChainNamespace", _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.CHAIN_NAMESPACES.EIP155);

    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(this, "type", _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_CATEGORY.EXTERNAL);

    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(this, "adapterOptions", void 0);

    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(this, "status", _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_STATUS.NOT_READY);

    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(this, "adapterData", {
      uri: "",
      extensionAdapters: WALLET_CONNECT_EXTENSION_ADAPTERS
    });

    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(this, "connector", null);

    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(this, "wcProvider", null);

    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(this, "rehydrated", false);

    this.adapterOptions = _objectSpread({}, options);
    this.chainConfig = options.chainConfig || null;
  }

  get connected() {
    var _this$connector;

    return !!((_this$connector = this.connector) !== null && _this$connector !== void 0 && _this$connector.connected);
  }

  get provider() {
    var _this$wcProvider;

    return ((_this$wcProvider = this.wcProvider) === null || _this$wcProvider === void 0 ? void 0 : _this$wcProvider.provider) || null;
  }

  set provider(_) {
    throw new Error("Not implemented");
  }

  async init() {
    super.checkInitializationRequirements();

    if (!this.chainConfig) {
      this.chainConfig = (0,_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.getChainConfig)(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.CHAIN_NAMESPACES.EIP155, 1);
    } // Create a connector


    this.connector = this.getWalletConnectInstance();
    this.wcProvider = new _web3auth_ethereum_provider__WEBPACK_IMPORTED_MODULE_3__.WalletConnectProvider({
      config: {
        chainConfig: this.chainConfig
      },
      connector: this.connector
    });
    this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.READY, _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WALLET_ADAPTERS.WALLET_CONNECT_V1);
    this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_STATUS.READY;
    _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.log.debug("initializing wallet connect v1 adapter");

    if (this.connector.connected) {
      this.rehydrated = true;
      await this.onConnectHandler({
        accounts: this.connector.accounts,
        chainId: this.connector.chainId
      });
    }
  }

  async connect() {
    super.checkConnectionRequirements();
    if (!this.connector) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletInitializationError.notReady("Wallet adapter is not ready yet");

    if (this.connected) {
      await this.onConnectHandler({
        accounts: this.connector.accounts,
        chainId: this.connector.chainId
      });
      return this.provider;
    }

    if (this.status !== _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_STATUS.CONNECTING) {
      var _this$adapterOptions$;

      // for wallet connect qr code modal we have to create a new connector, coz wallet connect internally does not open
      // modal again on existing instance if connection is pending.
      if ((_this$adapterOptions$ = this.adapterOptions.adapterSettings) !== null && _this$adapterOptions$ !== void 0 && _this$adapterOptions$.qrcodeModal) {
        var _this$adapterOptions$2;

        this.connector = this.getWalletConnectInstance();
        this.wcProvider = new _web3auth_ethereum_provider__WEBPACK_IMPORTED_MODULE_3__.WalletConnectProvider({
          config: {
            chainConfig: this.chainConfig,
            // network switching can be skipped with custom ui
            skipLookupNetwork: (_this$adapterOptions$2 = this.adapterOptions.adapterSettings) === null || _this$adapterOptions$2 === void 0 ? void 0 : _this$adapterOptions$2.skipNetworkSwitching
          },
          connector: this.connector
        });
      }

      await this.createNewSession();
      this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_STATUS.CONNECTING;
      this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.CONNECTING, {
        adapter: _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WALLET_ADAPTERS.WALLET_CONNECT_V1
      });
    }

    return new Promise((resolve, reject) => {
      if (!this.connector) return reject(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletInitializationError.notReady("Wallet adapter is not ready yet")); // for wallet connect default modal.

      this.connector.on("modal_closed", async () => {
        this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_STATUS.READY;
        this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.READY, _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WALLET_ADAPTERS.WALLET_CONNECT_V1);
        return reject(new Error("User closed modal"));
      });

      try {
        // Subscribe to session connection
        this.connector.on("connect", async (error, payload) => {
          if (error) {
            this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.ERRORED, error);
          }

          _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.log.debug("connected event emitted by web3auth");
          await this.onConnectHandler(payload.params[0]);
          return resolve(this.provider);
        });
      } catch (error) {
        _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.log.error("Wallet connect v1 adapter error while connecting", error); // ready again to be connected

        this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_STATUS.READY;
        this.rehydrated = true;
        this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.ERRORED, error);
        reject(error instanceof _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.Web3AuthError ? error : _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletLoginError.connectionError("Failed to login with wallet connect: ".concat((error === null || error === void 0 ? void 0 : error.message) || "")));
      }
    });
  }

  async getUserInfo() {
    if (!this.connected) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletLoginError.notConnectedError("Not connected with wallet, Please login/connect first");
    return {};
  }

  async disconnect() {
    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
      cleanup: false
    };
    const {
      cleanup
    } = options;
    if (!this.connector || !this.connected) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletLoginError.notConnectedError("Not connected with wallet");
    await this.connector.killSession();
    this.rehydrated = false;

    if (cleanup) {
      this.connector = null;
      this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_STATUS.NOT_READY;
      this.wcProvider = null;
    } else {
      // ready to connect again
      this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_STATUS.READY;
    }

    this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.DISCONNECTED);
  }

  async addChain(chainConfig) {
    try {
      var _this$adapterOptions$3;

      if (!this.wcProvider) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletInitializationError.notReady("Wallet adapter is not ready yet");
      const networkSwitch = (_this$adapterOptions$3 = this.adapterOptions.adapterSettings) === null || _this$adapterOptions$3 === void 0 ? void 0 : _this$adapterOptions$3.networkSwitchModal;

      if (networkSwitch) {
        await networkSwitch.addNetwork({
          chainConfig,
          appOrigin: window.location.hostname
        });
      }

      await this.wcProvider.addChain(chainConfig);
    } catch (error) {
      _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.log.error(error);
    }
  }

  async switchChain(connectedChainConfig, chainConfig) {
    var _this$adapterOptions$4;

    if (!this.wcProvider) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletInitializationError.notReady("Wallet adapter is not ready yet");
    const networkSwitch = (_this$adapterOptions$4 = this.adapterOptions.adapterSettings) === null || _this$adapterOptions$4 === void 0 ? void 0 : _this$adapterOptions$4.networkSwitchModal;

    if (networkSwitch) {
      await networkSwitch.switchNetwork({
        currentChainConfig: chainConfig,
        newChainConfig: connectedChainConfig,
        appOrigin: window.location.hostname
      });
    }

    await this.wcProvider.switchChain({
      chainId: chainConfig.chainId,
      lookup: false,
      addChain: false
    });
  }

  async createNewSession() {
    var _this$adapterOptions, _this$adapterOptions$5;

    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
      forceNewSession: false
    };
    if (!this.connector) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletInitializationError.notReady("Wallet adapter is not ready yet");

    if (opts.forceNewSession && this.connector.pending) {
      await this.connector.killSession();
    } // for wallet connect qr modal


    if ((_this$adapterOptions = this.adapterOptions) !== null && _this$adapterOptions !== void 0 && (_this$adapterOptions$5 = _this$adapterOptions.adapterSettings) !== null && _this$adapterOptions$5 !== void 0 && _this$adapterOptions$5.qrcodeModal) {
      var _this$chainConfig;

      await this.connector.createSession({
        chainId: parseInt(((_this$chainConfig = this.chainConfig) === null || _this$chainConfig === void 0 ? void 0 : _this$chainConfig.chainId) || "0x1", 16)
      });
      return;
    } // for web3auth qr code modal


    return new Promise((resolve, reject) => {
      var _this$chainConfig2;

      if (!this.connector) return reject(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletInitializationError.notReady("Wallet adapter is not ready yet"));
      _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.log.debug("creating new session for web3auth wallet connect");
      this.connector.on("display_uri", async (err, payload) => {
        var _this$connector2;

        if (err) {
          this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.ERRORED, _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletLoginError.connectionError("Failed to display wallet connect qr code"));
          return reject(err);
        }

        const uri = payload.params[0];
        this.updateAdapterData({
          uri,
          extensionAdapters: WALLET_CONNECT_EXTENSION_ADAPTERS
        });
        (_this$connector2 = this.connector) === null || _this$connector2 === void 0 ? void 0 : _this$connector2.off("display_uri");
        return resolve();
      });
      this.connector.createSession({
        chainId: parseInt(((_this$chainConfig2 = this.chainConfig) === null || _this$chainConfig2 === void 0 ? void 0 : _this$chainConfig2.chainId) || "0x1", 16)
      }).catch(error => {
        _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.log.error("error while creating new wallet connect session", error);
        this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.ERRORED, error);
        return reject(error);
      });
    });
  }

  async onConnectHandler(params) {
    if (!this.connector || !this.wcProvider) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletInitializationError.notReady("Wallet adapter is not ready yet");
    if (!this.chainConfig) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletInitializationError.invalidParams("Chain config is not set");
    const {
      chainId
    } = params;
    _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.log.debug("connected chainId in hex");

    if (chainId !== parseInt(this.chainConfig.chainId, 16)) {
      var _this$adapterOptions$6, _this$adapterOptions2, _this$adapterOptions3;

      const connectedChainConfig = (0,_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.getChainConfig)(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.CHAIN_NAMESPACES.EIP155, chainId) || {
        chainId: "0x".concat(chainId.toString(16)),
        displayName: "Unknown Network"
      };
      const isCustomUi = (_this$adapterOptions$6 = this.adapterOptions.adapterSettings) === null || _this$adapterOptions$6 === void 0 ? void 0 : _this$adapterOptions$6.qrcodeModal; // skipping network is not allowed in default ui. We are use network switching modal for default ui.

      if (!isCustomUi || isCustomUi && !((_this$adapterOptions2 = this.adapterOptions) !== null && _this$adapterOptions2 !== void 0 && (_this$adapterOptions3 = _this$adapterOptions2.adapterSettings) !== null && _this$adapterOptions3 !== void 0 && _this$adapterOptions3.skipNetworkSwitching)) {
        try {
          await this.addChain(this.chainConfig);
          await this.switchChain(connectedChainConfig, this.chainConfig);
          this.connector = this.getWalletConnectInstance();
        } catch (error) {
          _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.log.error("error while chain switching", error); // we need to create a new session since old session is already used and
          // user needs to login again with correct chain with new qr code.

          await this.createNewSession({
            forceNewSession: true
          });
          this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.ERRORED, _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WalletInitializationError.fromCode(5000, "Not connected to correct network. Expected: ".concat(this.chainConfig.displayName, ", Current: ").concat((connectedChainConfig === null || connectedChainConfig === void 0 ? void 0 : connectedChainConfig.displayName) || chainId, ", Please switch to correct network from wallet")));
          this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_STATUS.READY;
          this.rehydrated = true;
          return;
        }
      }
    }

    await this.wcProvider.setupProvider(this.connector);
    this.subscribeEvents(this.connector);
    this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_STATUS.CONNECTED;
    this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.CONNECTED, {
      adapter: _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.WALLET_ADAPTERS.WALLET_CONNECT_V1,
      reconnected: this.rehydrated
    });
  }

  subscribeEvents(connector) {
    connector.on("session_update", async error => {
      if (error) {
        this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.ADAPTER_EVENTS.ERRORED, error);
      }
    });
  }

  getWalletConnectInstance() {
    const walletConnectOptions = this.adapterOptions.adapterSettings || {};
    walletConnectOptions.bridge = walletConnectOptions.bridge || "https://bridge.walletconnect.org"; // Create a connector

    return new _walletconnect_client__WEBPACK_IMPORTED_MODULE_1__["default"](walletConnectOptions);
  }

}


//# sourceMappingURL=walletConnectV1Adapter.esm.js.map


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfd2ViM2F1dGhfd2FsbGV0LWNvbm5lY3QtdjEtYWRhcHRlcl9kaXN0X3dhbGxldENvbm5lY3RWMUFkYXB0ZXJfZXNtX2pzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQW9FO0FBQ2xCO0FBQ3FMO0FBQ25LOztBQUVwRTtBQUNBO0FBQ0EsV0FBVyxtRUFBdUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxXQUFXLG1FQUF1QjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQsMkNBQTJDLGdDQUFnQyxvQ0FBb0Msb0RBQW9ELDZEQUE2RCxpRUFBaUUsc0NBQXNDOztBQUV2VSxpQ0FBaUMsZ0JBQWdCLHNCQUFzQixPQUFPLHVEQUF1RCw2REFBNkQsaUZBQWUsNkJBQTZCLG9LQUFvSyxtRkFBbUYsS0FBSzs7QUFFMWUscUNBQXFDLHVEQUFXO0FBQ2hEO0FBQ0E7QUFDQTs7QUFFQSxJQUFJLGlGQUFlLGVBQWUsNkVBQWlDOztBQUVuRSxJQUFJLGlGQUFlLDJCQUEyQixxRUFBeUI7O0FBRXZFLElBQUksaUZBQWUsZ0NBQWdDLG1FQUF1Qjs7QUFFMUUsSUFBSSxpRkFBZSxlQUFlLHFFQUF5Qjs7QUFFM0QsSUFBSSxpRkFBZTs7QUFFbkIsSUFBSSxpRkFBZSxpQkFBaUIsb0VBQXdCOztBQUU1RCxJQUFJLGlGQUFlO0FBQ25CO0FBQ0E7QUFDQSxLQUFLOztBQUVMLElBQUksaUZBQWU7O0FBRW5CLElBQUksaUZBQWU7O0FBRW5CLElBQUksaUZBQWU7O0FBRW5CLDBDQUEwQztBQUMxQztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSx5QkFBeUIsOERBQWMsQ0FB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QUF3QztBQUMzRDs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYLG9CQUFvQixrRUFBc0IsRUFBRSw4RUFBa0M7QUFDOUUsd0JBQXdCLGdFQUFvQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrQkFBa0Isb0VBQXdCO0FBQzFDLGNBQWMsb0VBQXdCO0FBQ3RDLGVBQWUsNkVBQWlDO0FBQ2hEO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixrRUFBc0I7QUFDeEM7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBLHFHQUFxRzs7QUFFckcsZUFBZSw2REFBYTtBQUM1Qjs7QUFFQTs7QUFFa0M7QUFDbEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG9uaXNtbG0vLi9ub2RlX21vZHVsZXMvQHdlYjNhdXRoL3dhbGxldC1jb25uZWN0LXYxLWFkYXB0ZXIvZGlzdC93YWxsZXRDb25uZWN0VjFBZGFwdGVyLmVzbS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZGVmaW5lUHJvcGVydHknO1xuaW1wb3J0IFdhbGxldENvbm5lY3QgZnJvbSAnQHdhbGxldGNvbm5lY3QvY2xpZW50JztcbmltcG9ydCB7IENIQUlOX05BTUVTUEFDRVMsIEJhc2VBZGFwdGVyLCBXQUxMRVRfQURBUFRFUlMsIEFEQVBURVJfTkFNRVNQQUNFUywgQURBUFRFUl9DQVRFR09SWSwgQURBUFRFUl9TVEFUVVMsIGdldENoYWluQ29uZmlnLCBBREFQVEVSX0VWRU5UUywgbG9nLCBXYWxsZXRJbml0aWFsaXphdGlvbkVycm9yLCBXZWIzQXV0aEVycm9yLCBXYWxsZXRMb2dpbkVycm9yIH0gZnJvbSAnQHdlYjNhdXRoL2Jhc2UnO1xuaW1wb3J0IHsgV2FsbGV0Q29ubmVjdFByb3ZpZGVyIH0gZnJvbSAnQHdlYjNhdXRoL2V0aGVyZXVtLXByb3ZpZGVyJztcblxuY29uc3QgV0FMTEVUX0NPTk5FQ1RfRVhURU5TSU9OX0FEQVBURVJTID0gW3tcbiAgbmFtZTogXCJSYWluYm93XCIsXG4gIGNoYWluczogW0NIQUlOX05BTUVTUEFDRVMuRUlQMTU1XSxcbiAgbG9nbzogXCJodHRwczovL2ltYWdlcy53ZWIzYXV0aC5pby9sb2dpbi1yYWluYm93LnN2Z1wiLFxuICBtb2JpbGU6IHtcbiAgICBuYXRpdmU6IFwicmFpbmJvdzpcIixcbiAgICB1bml2ZXJzYWw6IFwiaHR0cHM6Ly9ybmJ3YXBwLmNvbVwiXG4gIH0sXG4gIGRlc2t0b3A6IHtcbiAgICBuYXRpdmU6IFwiXCIsXG4gICAgdW5pdmVyc2FsOiBcIlwiXG4gIH1cbn0sIHtcbiAgbmFtZTogXCJNZXRhTWFza1wiLFxuICBjaGFpbnM6IFtDSEFJTl9OQU1FU1BBQ0VTLkVJUDE1NV0sXG4gIGxvZ286IFwiaHR0cHM6Ly9pbWFnZXMud2ViM2F1dGguaW8vbG9naW4tbWV0YW1hc2suc3ZnXCIsXG4gIG1vYmlsZToge1xuICAgIG5hdGl2ZTogXCJtZXRhbWFzazpcIixcbiAgICB1bml2ZXJzYWw6IFwiaHR0cHM6Ly9tZXRhbWFzay5hcHAubGlua1wiXG4gIH0sXG4gIGRlc2t0b3A6IHtcbiAgICBuYXRpdmU6IFwiXCIsXG4gICAgdW5pdmVyc2FsOiBcIlwiXG4gIH1cbn1dO1xuXG5mdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgZW51bWVyYWJsZU9ubHkgJiYgKHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KSksIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfVxuXG5mdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gbnVsbCAhPSBhcmd1bWVudHNbaV0gPyBhcmd1bWVudHNbaV0gOiB7fTsgaSAlIDIgPyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKSA6IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gcmV0dXJuIHRhcmdldDsgfVxuXG5jbGFzcyBXYWxsZXRDb25uZWN0VjFBZGFwdGVyIGV4dGVuZHMgQmFzZUFkYXB0ZXIge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBsZXQgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gICAgc3VwZXIoKTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm5hbWVcIiwgV0FMTEVUX0FEQVBURVJTLldBTExFVF9DT05ORUNUX1YxKTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFkYXB0ZXJOYW1lc3BhY2VcIiwgQURBUFRFUl9OQU1FU1BBQ0VTLkVJUDE1NSk7XG5cbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJjdXJyZW50Q2hhaW5OYW1lc3BhY2VcIiwgQ0hBSU5fTkFNRVNQQUNFUy5FSVAxNTUpO1xuXG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwidHlwZVwiLCBBREFQVEVSX0NBVEVHT1JZLkVYVEVSTkFMKTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFkYXB0ZXJPcHRpb25zXCIsIHZvaWQgMCk7XG5cbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJzdGF0dXNcIiwgQURBUFRFUl9TVEFUVVMuTk9UX1JFQURZKTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFkYXB0ZXJEYXRhXCIsIHtcbiAgICAgIHVyaTogXCJcIixcbiAgICAgIGV4dGVuc2lvbkFkYXB0ZXJzOiBXQUxMRVRfQ09OTkVDVF9FWFRFTlNJT05fQURBUFRFUlNcbiAgICB9KTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbm5lY3RvclwiLCBudWxsKTtcblxuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIndjUHJvdmlkZXJcIiwgbnVsbCk7XG5cbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJyZWh5ZHJhdGVkXCIsIGZhbHNlKTtcblxuICAgIHRoaXMuYWRhcHRlck9wdGlvbnMgPSBfb2JqZWN0U3ByZWFkKHt9LCBvcHRpb25zKTtcbiAgICB0aGlzLmNoYWluQ29uZmlnID0gb3B0aW9ucy5jaGFpbkNvbmZpZyB8fCBudWxsO1xuICB9XG5cbiAgZ2V0IGNvbm5lY3RlZCgpIHtcbiAgICB2YXIgX3RoaXMkY29ubmVjdG9yO1xuXG4gICAgcmV0dXJuICEhKChfdGhpcyRjb25uZWN0b3IgPSB0aGlzLmNvbm5lY3RvcikgIT09IG51bGwgJiYgX3RoaXMkY29ubmVjdG9yICE9PSB2b2lkIDAgJiYgX3RoaXMkY29ubmVjdG9yLmNvbm5lY3RlZCk7XG4gIH1cblxuICBnZXQgcHJvdmlkZXIoKSB7XG4gICAgdmFyIF90aGlzJHdjUHJvdmlkZXI7XG5cbiAgICByZXR1cm4gKChfdGhpcyR3Y1Byb3ZpZGVyID0gdGhpcy53Y1Byb3ZpZGVyKSA9PT0gbnVsbCB8fCBfdGhpcyR3Y1Byb3ZpZGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR3Y1Byb3ZpZGVyLnByb3ZpZGVyKSB8fCBudWxsO1xuICB9XG5cbiAgc2V0IHByb3ZpZGVyKF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50ZWRcIik7XG4gIH1cblxuICBhc3luYyBpbml0KCkge1xuICAgIHN1cGVyLmNoZWNrSW5pdGlhbGl6YXRpb25SZXF1aXJlbWVudHMoKTtcblxuICAgIGlmICghdGhpcy5jaGFpbkNvbmZpZykge1xuICAgICAgdGhpcy5jaGFpbkNvbmZpZyA9IGdldENoYWluQ29uZmlnKENIQUlOX05BTUVTUEFDRVMuRUlQMTU1LCAxKTtcbiAgICB9IC8vIENyZWF0ZSBhIGNvbm5lY3RvclxuXG5cbiAgICB0aGlzLmNvbm5lY3RvciA9IHRoaXMuZ2V0V2FsbGV0Q29ubmVjdEluc3RhbmNlKCk7XG4gICAgdGhpcy53Y1Byb3ZpZGVyID0gbmV3IFdhbGxldENvbm5lY3RQcm92aWRlcih7XG4gICAgICBjb25maWc6IHtcbiAgICAgICAgY2hhaW5Db25maWc6IHRoaXMuY2hhaW5Db25maWdcbiAgICAgIH0sXG4gICAgICBjb25uZWN0b3I6IHRoaXMuY29ubmVjdG9yXG4gICAgfSk7XG4gICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLlJFQURZLCBXQUxMRVRfQURBUFRFUlMuV0FMTEVUX0NPTk5FQ1RfVjEpO1xuICAgIHRoaXMuc3RhdHVzID0gQURBUFRFUl9TVEFUVVMuUkVBRFk7XG4gICAgbG9nLmRlYnVnKFwiaW5pdGlhbGl6aW5nIHdhbGxldCBjb25uZWN0IHYxIGFkYXB0ZXJcIik7XG5cbiAgICBpZiAodGhpcy5jb25uZWN0b3IuY29ubmVjdGVkKSB7XG4gICAgICB0aGlzLnJlaHlkcmF0ZWQgPSB0cnVlO1xuICAgICAgYXdhaXQgdGhpcy5vbkNvbm5lY3RIYW5kbGVyKHtcbiAgICAgICAgYWNjb3VudHM6IHRoaXMuY29ubmVjdG9yLmFjY291bnRzLFxuICAgICAgICBjaGFpbklkOiB0aGlzLmNvbm5lY3Rvci5jaGFpbklkXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBjb25uZWN0KCkge1xuICAgIHN1cGVyLmNoZWNrQ29ubmVjdGlvblJlcXVpcmVtZW50cygpO1xuICAgIGlmICghdGhpcy5jb25uZWN0b3IpIHRocm93IFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3Iubm90UmVhZHkoXCJXYWxsZXQgYWRhcHRlciBpcyBub3QgcmVhZHkgeWV0XCIpO1xuXG4gICAgaWYgKHRoaXMuY29ubmVjdGVkKSB7XG4gICAgICBhd2FpdCB0aGlzLm9uQ29ubmVjdEhhbmRsZXIoe1xuICAgICAgICBhY2NvdW50czogdGhpcy5jb25uZWN0b3IuYWNjb3VudHMsXG4gICAgICAgIGNoYWluSWQ6IHRoaXMuY29ubmVjdG9yLmNoYWluSWRcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXMucHJvdmlkZXI7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc3RhdHVzICE9PSBBREFQVEVSX1NUQVRVUy5DT05ORUNUSU5HKSB7XG4gICAgICB2YXIgX3RoaXMkYWRhcHRlck9wdGlvbnMkO1xuXG4gICAgICAvLyBmb3Igd2FsbGV0IGNvbm5lY3QgcXIgY29kZSBtb2RhbCB3ZSBoYXZlIHRvIGNyZWF0ZSBhIG5ldyBjb25uZWN0b3IsIGNveiB3YWxsZXQgY29ubmVjdCBpbnRlcm5hbGx5IGRvZXMgbm90IG9wZW5cbiAgICAgIC8vIG1vZGFsIGFnYWluIG9uIGV4aXN0aW5nIGluc3RhbmNlIGlmIGNvbm5lY3Rpb24gaXMgcGVuZGluZy5cbiAgICAgIGlmICgoX3RoaXMkYWRhcHRlck9wdGlvbnMkID0gdGhpcy5hZGFwdGVyT3B0aW9ucy5hZGFwdGVyU2V0dGluZ3MpICE9PSBudWxsICYmIF90aGlzJGFkYXB0ZXJPcHRpb25zJCAhPT0gdm9pZCAwICYmIF90aGlzJGFkYXB0ZXJPcHRpb25zJC5xcmNvZGVNb2RhbCkge1xuICAgICAgICB2YXIgX3RoaXMkYWRhcHRlck9wdGlvbnMkMjtcblxuICAgICAgICB0aGlzLmNvbm5lY3RvciA9IHRoaXMuZ2V0V2FsbGV0Q29ubmVjdEluc3RhbmNlKCk7XG4gICAgICAgIHRoaXMud2NQcm92aWRlciA9IG5ldyBXYWxsZXRDb25uZWN0UHJvdmlkZXIoe1xuICAgICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgY2hhaW5Db25maWc6IHRoaXMuY2hhaW5Db25maWcsXG4gICAgICAgICAgICAvLyBuZXR3b3JrIHN3aXRjaGluZyBjYW4gYmUgc2tpcHBlZCB3aXRoIGN1c3RvbSB1aVxuICAgICAgICAgICAgc2tpcExvb2t1cE5ldHdvcms6IChfdGhpcyRhZGFwdGVyT3B0aW9ucyQyID0gdGhpcy5hZGFwdGVyT3B0aW9ucy5hZGFwdGVyU2V0dGluZ3MpID09PSBudWxsIHx8IF90aGlzJGFkYXB0ZXJPcHRpb25zJDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGFkYXB0ZXJPcHRpb25zJDIuc2tpcE5ldHdvcmtTd2l0Y2hpbmdcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbm5lY3RvcjogdGhpcy5jb25uZWN0b3JcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHRoaXMuY3JlYXRlTmV3U2Vzc2lvbigpO1xuICAgICAgdGhpcy5zdGF0dXMgPSBBREFQVEVSX1NUQVRVUy5DT05ORUNUSU5HO1xuICAgICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLkNPTk5FQ1RJTkcsIHtcbiAgICAgICAgYWRhcHRlcjogV0FMTEVUX0FEQVBURVJTLldBTExFVF9DT05ORUNUX1YxXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmNvbm5lY3RvcikgcmV0dXJuIHJlamVjdChXYWxsZXRJbml0aWFsaXphdGlvbkVycm9yLm5vdFJlYWR5KFwiV2FsbGV0IGFkYXB0ZXIgaXMgbm90IHJlYWR5IHlldFwiKSk7IC8vIGZvciB3YWxsZXQgY29ubmVjdCBkZWZhdWx0IG1vZGFsLlxuXG4gICAgICB0aGlzLmNvbm5lY3Rvci5vbihcIm1vZGFsX2Nsb3NlZFwiLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRoaXMuc3RhdHVzID0gQURBUFRFUl9TVEFUVVMuUkVBRFk7XG4gICAgICAgIHRoaXMuZW1pdChBREFQVEVSX0VWRU5UUy5SRUFEWSwgV0FMTEVUX0FEQVBURVJTLldBTExFVF9DT05ORUNUX1YxKTtcbiAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoXCJVc2VyIGNsb3NlZCBtb2RhbFwiKSk7XG4gICAgICB9KTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gU3Vic2NyaWJlIHRvIHNlc3Npb24gY29ubmVjdGlvblxuICAgICAgICB0aGlzLmNvbm5lY3Rvci5vbihcImNvbm5lY3RcIiwgYXN5bmMgKGVycm9yLCBwYXlsb2FkKSA9PiB7XG4gICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoQURBUFRFUl9FVkVOVFMuRVJST1JFRCwgZXJyb3IpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGxvZy5kZWJ1ZyhcImNvbm5lY3RlZCBldmVudCBlbWl0dGVkIGJ5IHdlYjNhdXRoXCIpO1xuICAgICAgICAgIGF3YWl0IHRoaXMub25Db25uZWN0SGFuZGxlcihwYXlsb2FkLnBhcmFtc1swXSk7XG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUodGhpcy5wcm92aWRlcik7XG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nLmVycm9yKFwiV2FsbGV0IGNvbm5lY3QgdjEgYWRhcHRlciBlcnJvciB3aGlsZSBjb25uZWN0aW5nXCIsIGVycm9yKTsgLy8gcmVhZHkgYWdhaW4gdG8gYmUgY29ubmVjdGVkXG5cbiAgICAgICAgdGhpcy5zdGF0dXMgPSBBREFQVEVSX1NUQVRVUy5SRUFEWTtcbiAgICAgICAgdGhpcy5yZWh5ZHJhdGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLkVSUk9SRUQsIGVycm9yKTtcbiAgICAgICAgcmVqZWN0KGVycm9yIGluc3RhbmNlb2YgV2ViM0F1dGhFcnJvciA/IGVycm9yIDogV2FsbGV0TG9naW5FcnJvci5jb25uZWN0aW9uRXJyb3IoXCJGYWlsZWQgdG8gbG9naW4gd2l0aCB3YWxsZXQgY29ubmVjdDogXCIuY29uY2F0KChlcnJvciA9PT0gbnVsbCB8fCBlcnJvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogZXJyb3IubWVzc2FnZSkgfHwgXCJcIikpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGdldFVzZXJJbmZvKCkge1xuICAgIGlmICghdGhpcy5jb25uZWN0ZWQpIHRocm93IFdhbGxldExvZ2luRXJyb3Iubm90Q29ubmVjdGVkRXJyb3IoXCJOb3QgY29ubmVjdGVkIHdpdGggd2FsbGV0LCBQbGVhc2UgbG9naW4vY29ubmVjdCBmaXJzdFwiKTtcbiAgICByZXR1cm4ge307XG4gIH1cblxuICBhc3luYyBkaXNjb25uZWN0KCkge1xuICAgIGxldCBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7XG4gICAgICBjbGVhbnVwOiBmYWxzZVxuICAgIH07XG4gICAgY29uc3Qge1xuICAgICAgY2xlYW51cFxuICAgIH0gPSBvcHRpb25zO1xuICAgIGlmICghdGhpcy5jb25uZWN0b3IgfHwgIXRoaXMuY29ubmVjdGVkKSB0aHJvdyBXYWxsZXRMb2dpbkVycm9yLm5vdENvbm5lY3RlZEVycm9yKFwiTm90IGNvbm5lY3RlZCB3aXRoIHdhbGxldFwiKTtcbiAgICBhd2FpdCB0aGlzLmNvbm5lY3Rvci5raWxsU2Vzc2lvbigpO1xuICAgIHRoaXMucmVoeWRyYXRlZCA9IGZhbHNlO1xuXG4gICAgaWYgKGNsZWFudXApIHtcbiAgICAgIHRoaXMuY29ubmVjdG9yID0gbnVsbDtcbiAgICAgIHRoaXMuc3RhdHVzID0gQURBUFRFUl9TVEFUVVMuTk9UX1JFQURZO1xuICAgICAgdGhpcy53Y1Byb3ZpZGVyID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gcmVhZHkgdG8gY29ubmVjdCBhZ2FpblxuICAgICAgdGhpcy5zdGF0dXMgPSBBREFQVEVSX1NUQVRVUy5SRUFEWTtcbiAgICB9XG5cbiAgICB0aGlzLmVtaXQoQURBUFRFUl9FVkVOVFMuRElTQ09OTkVDVEVEKTtcbiAgfVxuXG4gIGFzeW5jIGFkZENoYWluKGNoYWluQ29uZmlnKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBfdGhpcyRhZGFwdGVyT3B0aW9ucyQzO1xuXG4gICAgICBpZiAoIXRoaXMud2NQcm92aWRlcikgdGhyb3cgV2FsbGV0SW5pdGlhbGl6YXRpb25FcnJvci5ub3RSZWFkeShcIldhbGxldCBhZGFwdGVyIGlzIG5vdCByZWFkeSB5ZXRcIik7XG4gICAgICBjb25zdCBuZXR3b3JrU3dpdGNoID0gKF90aGlzJGFkYXB0ZXJPcHRpb25zJDMgPSB0aGlzLmFkYXB0ZXJPcHRpb25zLmFkYXB0ZXJTZXR0aW5ncykgPT09IG51bGwgfHwgX3RoaXMkYWRhcHRlck9wdGlvbnMkMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkYWRhcHRlck9wdGlvbnMkMy5uZXR3b3JrU3dpdGNoTW9kYWw7XG5cbiAgICAgIGlmIChuZXR3b3JrU3dpdGNoKSB7XG4gICAgICAgIGF3YWl0IG5ldHdvcmtTd2l0Y2guYWRkTmV0d29yayh7XG4gICAgICAgICAgY2hhaW5Db25maWcsXG4gICAgICAgICAgYXBwT3JpZ2luOiB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWVcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHRoaXMud2NQcm92aWRlci5hZGRDaGFpbihjaGFpbkNvbmZpZyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcihlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc3dpdGNoQ2hhaW4oY29ubmVjdGVkQ2hhaW5Db25maWcsIGNoYWluQ29uZmlnKSB7XG4gICAgdmFyIF90aGlzJGFkYXB0ZXJPcHRpb25zJDQ7XG5cbiAgICBpZiAoIXRoaXMud2NQcm92aWRlcikgdGhyb3cgV2FsbGV0SW5pdGlhbGl6YXRpb25FcnJvci5ub3RSZWFkeShcIldhbGxldCBhZGFwdGVyIGlzIG5vdCByZWFkeSB5ZXRcIik7XG4gICAgY29uc3QgbmV0d29ya1N3aXRjaCA9IChfdGhpcyRhZGFwdGVyT3B0aW9ucyQ0ID0gdGhpcy5hZGFwdGVyT3B0aW9ucy5hZGFwdGVyU2V0dGluZ3MpID09PSBudWxsIHx8IF90aGlzJGFkYXB0ZXJPcHRpb25zJDQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGFkYXB0ZXJPcHRpb25zJDQubmV0d29ya1N3aXRjaE1vZGFsO1xuXG4gICAgaWYgKG5ldHdvcmtTd2l0Y2gpIHtcbiAgICAgIGF3YWl0IG5ldHdvcmtTd2l0Y2guc3dpdGNoTmV0d29yayh7XG4gICAgICAgIGN1cnJlbnRDaGFpbkNvbmZpZzogY2hhaW5Db25maWcsXG4gICAgICAgIG5ld0NoYWluQ29uZmlnOiBjb25uZWN0ZWRDaGFpbkNvbmZpZyxcbiAgICAgICAgYXBwT3JpZ2luOiB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWVcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMud2NQcm92aWRlci5zd2l0Y2hDaGFpbih7XG4gICAgICBjaGFpbklkOiBjaGFpbkNvbmZpZy5jaGFpbklkLFxuICAgICAgbG9va3VwOiBmYWxzZSxcbiAgICAgIGFkZENoYWluOiBmYWxzZVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlTmV3U2Vzc2lvbigpIHtcbiAgICB2YXIgX3RoaXMkYWRhcHRlck9wdGlvbnMsIF90aGlzJGFkYXB0ZXJPcHRpb25zJDU7XG5cbiAgICBsZXQgb3B0cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge1xuICAgICAgZm9yY2VOZXdTZXNzaW9uOiBmYWxzZVxuICAgIH07XG4gICAgaWYgKCF0aGlzLmNvbm5lY3RvcikgdGhyb3cgV2FsbGV0SW5pdGlhbGl6YXRpb25FcnJvci5ub3RSZWFkeShcIldhbGxldCBhZGFwdGVyIGlzIG5vdCByZWFkeSB5ZXRcIik7XG5cbiAgICBpZiAob3B0cy5mb3JjZU5ld1Nlc3Npb24gJiYgdGhpcy5jb25uZWN0b3IucGVuZGluZykge1xuICAgICAgYXdhaXQgdGhpcy5jb25uZWN0b3Iua2lsbFNlc3Npb24oKTtcbiAgICB9IC8vIGZvciB3YWxsZXQgY29ubmVjdCBxciBtb2RhbFxuXG5cbiAgICBpZiAoKF90aGlzJGFkYXB0ZXJPcHRpb25zID0gdGhpcy5hZGFwdGVyT3B0aW9ucykgIT09IG51bGwgJiYgX3RoaXMkYWRhcHRlck9wdGlvbnMgIT09IHZvaWQgMCAmJiAoX3RoaXMkYWRhcHRlck9wdGlvbnMkNSA9IF90aGlzJGFkYXB0ZXJPcHRpb25zLmFkYXB0ZXJTZXR0aW5ncykgIT09IG51bGwgJiYgX3RoaXMkYWRhcHRlck9wdGlvbnMkNSAhPT0gdm9pZCAwICYmIF90aGlzJGFkYXB0ZXJPcHRpb25zJDUucXJjb2RlTW9kYWwpIHtcbiAgICAgIHZhciBfdGhpcyRjaGFpbkNvbmZpZztcblxuICAgICAgYXdhaXQgdGhpcy5jb25uZWN0b3IuY3JlYXRlU2Vzc2lvbih7XG4gICAgICAgIGNoYWluSWQ6IHBhcnNlSW50KCgoX3RoaXMkY2hhaW5Db25maWcgPSB0aGlzLmNoYWluQ29uZmlnKSA9PT0gbnVsbCB8fCBfdGhpcyRjaGFpbkNvbmZpZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkY2hhaW5Db25maWcuY2hhaW5JZCkgfHwgXCIweDFcIiwgMTYpXG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIGZvciB3ZWIzYXV0aCBxciBjb2RlIG1vZGFsXG5cblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB2YXIgX3RoaXMkY2hhaW5Db25maWcyO1xuXG4gICAgICBpZiAoIXRoaXMuY29ubmVjdG9yKSByZXR1cm4gcmVqZWN0KFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3Iubm90UmVhZHkoXCJXYWxsZXQgYWRhcHRlciBpcyBub3QgcmVhZHkgeWV0XCIpKTtcbiAgICAgIGxvZy5kZWJ1ZyhcImNyZWF0aW5nIG5ldyBzZXNzaW9uIGZvciB3ZWIzYXV0aCB3YWxsZXQgY29ubmVjdFwiKTtcbiAgICAgIHRoaXMuY29ubmVjdG9yLm9uKFwiZGlzcGxheV91cmlcIiwgYXN5bmMgKGVyciwgcGF5bG9hZCkgPT4ge1xuICAgICAgICB2YXIgX3RoaXMkY29ubmVjdG9yMjtcblxuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLkVSUk9SRUQsIFdhbGxldExvZ2luRXJyb3IuY29ubmVjdGlvbkVycm9yKFwiRmFpbGVkIHRvIGRpc3BsYXkgd2FsbGV0IGNvbm5lY3QgcXIgY29kZVwiKSk7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdXJpID0gcGF5bG9hZC5wYXJhbXNbMF07XG4gICAgICAgIHRoaXMudXBkYXRlQWRhcHRlckRhdGEoe1xuICAgICAgICAgIHVyaSxcbiAgICAgICAgICBleHRlbnNpb25BZGFwdGVyczogV0FMTEVUX0NPTk5FQ1RfRVhURU5TSU9OX0FEQVBURVJTXG4gICAgICAgIH0pO1xuICAgICAgICAoX3RoaXMkY29ubmVjdG9yMiA9IHRoaXMuY29ubmVjdG9yKSA9PT0gbnVsbCB8fCBfdGhpcyRjb25uZWN0b3IyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRjb25uZWN0b3IyLm9mZihcImRpc3BsYXlfdXJpXCIpO1xuICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmNvbm5lY3Rvci5jcmVhdGVTZXNzaW9uKHtcbiAgICAgICAgY2hhaW5JZDogcGFyc2VJbnQoKChfdGhpcyRjaGFpbkNvbmZpZzIgPSB0aGlzLmNoYWluQ29uZmlnKSA9PT0gbnVsbCB8fCBfdGhpcyRjaGFpbkNvbmZpZzIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGNoYWluQ29uZmlnMi5jaGFpbklkKSB8fCBcIjB4MVwiLCAxNilcbiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgbG9nLmVycm9yKFwiZXJyb3Igd2hpbGUgY3JlYXRpbmcgbmV3IHdhbGxldCBjb25uZWN0IHNlc3Npb25cIiwgZXJyb3IpO1xuICAgICAgICB0aGlzLmVtaXQoQURBUFRFUl9FVkVOVFMuRVJST1JFRCwgZXJyb3IpO1xuICAgICAgICByZXR1cm4gcmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgb25Db25uZWN0SGFuZGxlcihwYXJhbXMpIHtcbiAgICBpZiAoIXRoaXMuY29ubmVjdG9yIHx8ICF0aGlzLndjUHJvdmlkZXIpIHRocm93IFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3Iubm90UmVhZHkoXCJXYWxsZXQgYWRhcHRlciBpcyBub3QgcmVhZHkgeWV0XCIpO1xuICAgIGlmICghdGhpcy5jaGFpbkNvbmZpZykgdGhyb3cgV2FsbGV0SW5pdGlhbGl6YXRpb25FcnJvci5pbnZhbGlkUGFyYW1zKFwiQ2hhaW4gY29uZmlnIGlzIG5vdCBzZXRcIik7XG4gICAgY29uc3Qge1xuICAgICAgY2hhaW5JZFxuICAgIH0gPSBwYXJhbXM7XG4gICAgbG9nLmRlYnVnKFwiY29ubmVjdGVkIGNoYWluSWQgaW4gaGV4XCIpO1xuXG4gICAgaWYgKGNoYWluSWQgIT09IHBhcnNlSW50KHRoaXMuY2hhaW5Db25maWcuY2hhaW5JZCwgMTYpKSB7XG4gICAgICB2YXIgX3RoaXMkYWRhcHRlck9wdGlvbnMkNiwgX3RoaXMkYWRhcHRlck9wdGlvbnMyLCBfdGhpcyRhZGFwdGVyT3B0aW9uczM7XG5cbiAgICAgIGNvbnN0IGNvbm5lY3RlZENoYWluQ29uZmlnID0gZ2V0Q2hhaW5Db25maWcoQ0hBSU5fTkFNRVNQQUNFUy5FSVAxNTUsIGNoYWluSWQpIHx8IHtcbiAgICAgICAgY2hhaW5JZDogXCIweFwiLmNvbmNhdChjaGFpbklkLnRvU3RyaW5nKDE2KSksXG4gICAgICAgIGRpc3BsYXlOYW1lOiBcIlVua25vd24gTmV0d29ya1wiXG4gICAgICB9O1xuICAgICAgY29uc3QgaXNDdXN0b21VaSA9IChfdGhpcyRhZGFwdGVyT3B0aW9ucyQ2ID0gdGhpcy5hZGFwdGVyT3B0aW9ucy5hZGFwdGVyU2V0dGluZ3MpID09PSBudWxsIHx8IF90aGlzJGFkYXB0ZXJPcHRpb25zJDYgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGFkYXB0ZXJPcHRpb25zJDYucXJjb2RlTW9kYWw7IC8vIHNraXBwaW5nIG5ldHdvcmsgaXMgbm90IGFsbG93ZWQgaW4gZGVmYXVsdCB1aS4gV2UgYXJlIHVzZSBuZXR3b3JrIHN3aXRjaGluZyBtb2RhbCBmb3IgZGVmYXVsdCB1aS5cblxuICAgICAgaWYgKCFpc0N1c3RvbVVpIHx8IGlzQ3VzdG9tVWkgJiYgISgoX3RoaXMkYWRhcHRlck9wdGlvbnMyID0gdGhpcy5hZGFwdGVyT3B0aW9ucykgIT09IG51bGwgJiYgX3RoaXMkYWRhcHRlck9wdGlvbnMyICE9PSB2b2lkIDAgJiYgKF90aGlzJGFkYXB0ZXJPcHRpb25zMyA9IF90aGlzJGFkYXB0ZXJPcHRpb25zMi5hZGFwdGVyU2V0dGluZ3MpICE9PSBudWxsICYmIF90aGlzJGFkYXB0ZXJPcHRpb25zMyAhPT0gdm9pZCAwICYmIF90aGlzJGFkYXB0ZXJPcHRpb25zMy5za2lwTmV0d29ya1N3aXRjaGluZykpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLmFkZENoYWluKHRoaXMuY2hhaW5Db25maWcpO1xuICAgICAgICAgIGF3YWl0IHRoaXMuc3dpdGNoQ2hhaW4oY29ubmVjdGVkQ2hhaW5Db25maWcsIHRoaXMuY2hhaW5Db25maWcpO1xuICAgICAgICAgIHRoaXMuY29ubmVjdG9yID0gdGhpcy5nZXRXYWxsZXRDb25uZWN0SW5zdGFuY2UoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBsb2cuZXJyb3IoXCJlcnJvciB3aGlsZSBjaGFpbiBzd2l0Y2hpbmdcIiwgZXJyb3IpOyAvLyB3ZSBuZWVkIHRvIGNyZWF0ZSBhIG5ldyBzZXNzaW9uIHNpbmNlIG9sZCBzZXNzaW9uIGlzIGFscmVhZHkgdXNlZCBhbmRcbiAgICAgICAgICAvLyB1c2VyIG5lZWRzIHRvIGxvZ2luIGFnYWluIHdpdGggY29ycmVjdCBjaGFpbiB3aXRoIG5ldyBxciBjb2RlLlxuXG4gICAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVOZXdTZXNzaW9uKHtcbiAgICAgICAgICAgIGZvcmNlTmV3U2Vzc2lvbjogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRoaXMuZW1pdChBREFQVEVSX0VWRU5UUy5FUlJPUkVELCBXYWxsZXRJbml0aWFsaXphdGlvbkVycm9yLmZyb21Db2RlKDUwMDAsIFwiTm90IGNvbm5lY3RlZCB0byBjb3JyZWN0IG5ldHdvcmsuIEV4cGVjdGVkOiBcIi5jb25jYXQodGhpcy5jaGFpbkNvbmZpZy5kaXNwbGF5TmFtZSwgXCIsIEN1cnJlbnQ6IFwiKS5jb25jYXQoKGNvbm5lY3RlZENoYWluQ29uZmlnID09PSBudWxsIHx8IGNvbm5lY3RlZENoYWluQ29uZmlnID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25uZWN0ZWRDaGFpbkNvbmZpZy5kaXNwbGF5TmFtZSkgfHwgY2hhaW5JZCwgXCIsIFBsZWFzZSBzd2l0Y2ggdG8gY29ycmVjdCBuZXR3b3JrIGZyb20gd2FsbGV0XCIpKSk7XG4gICAgICAgICAgdGhpcy5zdGF0dXMgPSBBREFQVEVSX1NUQVRVUy5SRUFEWTtcbiAgICAgICAgICB0aGlzLnJlaHlkcmF0ZWQgPSB0cnVlO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGF3YWl0IHRoaXMud2NQcm92aWRlci5zZXR1cFByb3ZpZGVyKHRoaXMuY29ubmVjdG9yKTtcbiAgICB0aGlzLnN1YnNjcmliZUV2ZW50cyh0aGlzLmNvbm5lY3Rvcik7XG4gICAgdGhpcy5zdGF0dXMgPSBBREFQVEVSX1NUQVRVUy5DT05ORUNURUQ7XG4gICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLkNPTk5FQ1RFRCwge1xuICAgICAgYWRhcHRlcjogV0FMTEVUX0FEQVBURVJTLldBTExFVF9DT05ORUNUX1YxLFxuICAgICAgcmVjb25uZWN0ZWQ6IHRoaXMucmVoeWRyYXRlZFxuICAgIH0pO1xuICB9XG5cbiAgc3Vic2NyaWJlRXZlbnRzKGNvbm5lY3Rvcikge1xuICAgIGNvbm5lY3Rvci5vbihcInNlc3Npb25fdXBkYXRlXCIsIGFzeW5jIGVycm9yID0+IHtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICB0aGlzLmVtaXQoQURBUFRFUl9FVkVOVFMuRVJST1JFRCwgZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZ2V0V2FsbGV0Q29ubmVjdEluc3RhbmNlKCkge1xuICAgIGNvbnN0IHdhbGxldENvbm5lY3RPcHRpb25zID0gdGhpcy5hZGFwdGVyT3B0aW9ucy5hZGFwdGVyU2V0dGluZ3MgfHwge307XG4gICAgd2FsbGV0Q29ubmVjdE9wdGlvbnMuYnJpZGdlID0gd2FsbGV0Q29ubmVjdE9wdGlvbnMuYnJpZGdlIHx8IFwiaHR0cHM6Ly9icmlkZ2Uud2FsbGV0Y29ubmVjdC5vcmdcIjsgLy8gQ3JlYXRlIGEgY29ubmVjdG9yXG5cbiAgICByZXR1cm4gbmV3IFdhbGxldENvbm5lY3Qod2FsbGV0Q29ubmVjdE9wdGlvbnMpO1xuICB9XG5cbn1cblxuZXhwb3J0IHsgV2FsbGV0Q29ubmVjdFYxQWRhcHRlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9d2FsbGV0Q29ubmVjdFYxQWRhcHRlci5lc20uanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=